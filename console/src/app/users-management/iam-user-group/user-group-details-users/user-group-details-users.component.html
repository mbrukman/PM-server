<div>
  <div class="row pt-5 pb-5 d-flex justify-content-between text-white">
    <a class="kh-btn kh-btn-blue" (click)="openAttachUsersModal()"
      >Attach Users</a
    >
    <app-filter-text-input
      placeholder="Search"
      (onChange)="this.userFilterSubject.next($event)"
    ></app-filter-text-input>
  </div>
  <p-table
    *ngIf="userGroup$ | async as userGroup"
    [sortMode]="'multiple'"
    [value]="userGroup.users"
  >
    <ng-template pTemplate="header">
      <tr>
        <th [pSortableColumn]="'name'" class="font-weight-normal font-roboto">
          Users
          <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th
          [pSortableColumn]="'groups.length'"
          class="font-weight-normal font-roboto"
        >
          Groups
          <p-sortIcon field="groups.length"></p-sortIcon>
        </th>
        <th class="font-weight-normal font-roboto">Detach</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
      <ng-template #tooltip>
        <ul class="tooltip-list" *ngIf="user.groups.length">
          <li *ngFor="let userGroup of user.groups" class="pb-1 pt-1">
            <a
              href=""
              routerLink="/admin/users-management/groups/{{ userGroup._id }}"
            >
              {{ userGroup.name }}
            </a>
          </li>
        </ul>
      </ng-template>
      <tr>
        <td colspan="1">
          <span class="ml-1">
            {{ user.name }}
          </span>
        </td>
        <td rowspan="1">
          <div
            class="cube-bordered"
            [tooltip]="tooltip"
            triggers="click:click"
            placement="right"
          >
            {{ user.groups.length }}
          </div>
        </td>
        <td rowspan="1">
          <button
            class="btn btn-link text-white ml-2"
            (click)="openDetachConfirmationModal(user)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="30"
              height="30"
              stroke="null"
            >
              <!-- Created with Method Draw - http://github.com/duopixel/Method-Draw/ -->

              <g>
                <title>background</title>
              </g>
              <g stroke="null">
                <title stroke="null">Layer 1</title>
                <g stroke="null" id="svg_12">
                  <g
                    stroke="null"
                    transform="matrix(1.39974 0 0 1.31809 95.7642 117.53)"
                    id="svg_5"
                  >
                    <g stroke="null" id="svg_6">
                      <path
                        stroke="null"
                        fill="#ffffff"
                        id="svg_7"
                        d="m-55.858067,-82.004326l2.5,2.5l-1.700001,1.699997l1.200001,1.200005l2,-2l0.400017,0c0.5,0 1.099991,-0.200005 1.5,-0.600006c0.299992,-0.299995 0.399986,-0.599998 0.399986,-1c0,-0.399994 -0.199997,-0.699989 -0.399986,-0.899994l-4.200012,-4.200005c-0.299995,-0.299995 -0.60001,-0.399994 -1.000004,-0.399994c-0.400005,-0.100006 -0.700001,0.099998 -0.900002,0.299995c-0.399994,0.400002 -0.600002,1 -0.600002,1.500008l0,0.399994l-1.999996,2l1.099995,1.199997l1.700005,-1.699997zm0.700001,-2.400002l4.100006,4.099998l-0.700005,0.300003l-3.800007,-3.800003l0.400005,-0.599998z"
                      />
                    </g>
                    <g stroke="null" id="svg_8">
                      <path
                        stroke="null"
                        fill="#ffffff"
                        id="svg_9"
                        d="m-56.158066,-74.704323l0.100006,2.199997c0,0 0,0.099998 0,0.099998l-6.899994,-6.900002c0,0 0.099991,0 0.099991,0l2.200001,0.099998l-1.699997,-1.799995l-0.299999,0c0,0 -0.100002,0 -0.100002,0c-0.299999,0 -0.700005,0.099991 -1,0.299995l-1.600002,1.400002l3.899998,3.899994l-3.000004,3.000008l-1.099991,2.599998l2.600006,-1.099998l2.999985,-3l3.900009,3.900002l1.099995,-1.100006l0.300007,-0.399994c0.199997,-0.400002 0.299999,-0.800003 0.299999,-1.100006l0,-0.299995l-1.800007,-1.799995z"
                      />
                    </g>
                    <g stroke="null" id="svg_10">
                      <rect
                        stroke="null"
                        fill="#ffffff"
                        id="svg_11"
                        height="20"
                        width="1.9"
                        transform="matrix(0.7071 -0.7071 0.7071 0.7071 -3.0827 8.0957)"
                        y="-109.230375"
                        x="21.616423"
                      />
                    </g>
                  </g>
                </g>
              </g>
            </svg>
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
